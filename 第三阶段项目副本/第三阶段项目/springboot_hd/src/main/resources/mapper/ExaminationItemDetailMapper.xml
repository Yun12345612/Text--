<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.example.springboot_hd.mapper.ExaminationItemDetailMapper">

    <!-- 新增 -->
    <insert id="insert" parameterType="org.example.springboot_hd.entity.ExaminationItemDetail"
            useGeneratedKeys="true" keyProperty="detailId">
        INSERT INTO examination_item_detail (
            detail_name, detail_unit, min_value, max_value,
            detail_desc, detail_status, create_time, update_time,
            department_name, detail_is_delete
        ) VALUES (
                     #{detailName}, #{detailUnit}, #{minValue}, #{maxValue},
                     #{detailDesc}, #{detailStatus}, #{createTime}, #{updateTime},
                     #{departmentName}, #{detailIsDelete}
                 )
    </insert>

    <!-- 软删除 -->
    <update id="softDeleteById">
        UPDATE examination_item_detail
        SET detail_is_delete = 1
        WHERE detail_id = #{detailId} AND detail_is_delete = 0
    </update>

    <!-- 根据ID查询 -->
    <select id="selectById" resultType="org.example.springboot_hd.entity.ExaminationItemDetail">
        SELECT * FROM examination_item_detail
        WHERE detail_id = #{detailId} AND detail_is_delete = 0
    </select>

    <!-- 查询所有 -->
    <select id="selectAll" resultType="org.example.springboot_hd.entity.ExaminationItemDetail">
        SELECT * FROM examination_item_detail
        WHERE detail_is_delete = 0
        ORDER BY create_time DESC
    </select>

    <!-- 分页查询 -->
    <select id="selectPage" parameterType="map" resultType="org.example.springboot_hd.entity.ExaminationItemDetail">
        SELECT * FROM examination_item_detail
        WHERE detail_is_delete = 0
        ORDER BY create_time DESC
            LIMIT #{offset}, #{pageSize}
    </select>

    <!-- 统计总数 -->
    <select id="count" resultType="java.lang.Long">
        SELECT COUNT(*) FROM examination_item_detail
        WHERE detail_is_delete = 0
    </select>

    <!-- 更新 -->
    <update id="update" parameterType="org.example.springboot_hd.entity.ExaminationItemDetail">
        UPDATE examination_item_detail
        <set>
            <if test="detailName != null and detailName != ''">
                detail_name = #{detailName},
            </if>
            <if test="detailUnit != null and detailUnit != ''">
                detail_unit = #{detailUnit},
            </if>
            <if test="minValue != null">
                min_value = #{minValue},
            </if>
            <if test="maxValue != null">
                max_value = #{maxValue},
            </if>
            <if test="detailDesc != null">
                detail_desc = #{detailDesc},
            </if>
            <if test="detailStatus != null and detailStatus != ''">
                detail_status = #{detailStatus},
            </if>
            <if test="updateTime != null">
                update_time = #{updateTime},
            </if>
            <if test="departmentName != null">
                department_name = #{departmentName},
            </if>
        </set>
        WHERE detail_id = #{detailId} AND detail_is_delete = 0
    </update>

    <!-- 根据条件查询 -->
    <select id="selectByCondition" parameterType="org.example.springboot_hd.entity.ExaminationItemDetail"
            resultType="org.example.springboot_hd.entity.ExaminationItemDetail">
        SELECT * FROM examination_item_detail
        WHERE detail_is_delete = 0
        <if test="detailName != null and detailName != ''">
            AND detail_name LIKE CONCAT('%', #{detailName}, '%')
        </if>
        <if test="detailStatus != null and detailStatus != ''">
            AND detail_status = #{detailStatus}
        </if>
        <if test="departmentName != null">
            AND department_name = #{departmentName}
        </if>
        <if test="itemId != null">
            AND item_id = #{itemId}
        </if>
        ORDER BY create_time DESC
    </select>

</mapper>